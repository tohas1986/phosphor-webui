<div class="uib-modal__content  modal__local-users">
  <div class="modal-header">
    <h2 class="modal-title" id="dialog_label">
      {{ dataService.language == 'ru' ? (modalCtrl.user.new ? 'Добавить пользователя':'Изменить пользователя') : (modalCtrl.user.new ? 'Add user':'Modify user') }}
    </h2>
    <button aria-label="Close" type="button" class="btn btn--close float-right" ng-click="$dismiss()">
      <icon file="icon-close.svg"></icon>
    </button>
  </div>
  <form name="form">
    <div class="modal-body">
      <!-- Manual unlock -->
      <div class="row" ng-if="modalCtrl.user.locked && !modalCtrl.automaticLockout">
        <div class="column medium-6">
          <div class="notification-banner" aria-live="polite" ng-class="{'notification-banner--warning': !form.lock.$dirty, 'notification-banner--information': form.lock.$dirty}">
            <p class="notification-banner__text" ng-if="!form.lock.$dirty">{{ dataService.language == 'ru' ? 'Учетная запись заблокирована':'Account locked' }}</p>
            <p class="notification-banner__text" ng-if="form.lock.$dirty">{{ dataService.language == 'ru' ? 'Нажмите "Разблокировать" для разблокировки учетной записи':'Click "Unlock" to unlock account' }}</p>
          </div>
        </div>
        <div class="column medium-6">
          <input type="hidden" name="lock" ng-model="modalCtrl.manualUnlockProperty" value="false">
          <button class="btn btn-primary" type="button" ng-click="form.lock.$setDirty()"
            ng-disabled="form.lock.$dirty">{{ dataService.language == 'ru' ? 'Разблокировать':'Unlock' }}</button>
        </div>
      </div>

      <!-- Username-->
      <div class="row">
        <div class="column medium-6">
          <div class="field-group-container">
            <legend>{{ dataService.language == 'ru' ? 'Имя пользователя':'Username' }}</legend>

            <input id="username" name="username" type="text" required minlength="1" maxlength="16"
              ng-pattern="'^([a-zA-Z_][a-zA-Z0-9_]*)'" ng-readonly="modalCtrl.user.isRoot"
              ng-model="modalCtrl.user.username" username-validator existing-usernames="modalCtrl.existingUsernames" />
            <div ng-if="form.username.$invalid && form.username.$touched" class="form__validation-message">
              <span ng-show="form.username.$error.required">{{ dataService.language == 'ru' ? 'Обязательное поле':'Field is required' }}</span>
              <span ng-show="form.username.$error.minlength || form.username.$error.maxlength">{{ dataService.language == 'ru' ? 'Длина должна быть между':'Length must be between' }} <span class="nowrap">1 – 16</span> {{ dataService.language == 'ru' ? 'символов':'characters' }}</span>
              <span ng-show="form.username.$error.pattern">{{ dataService.language == 'ru' ? 'Неверный формат':'Invalid format' }}</span>
              <span ng-show="form.username.$error.duplicateUsername">{{ dataService.language == 'ru' ? 'Имя пользователя уже существует':'Username already exists' }}</span>
            </div>
          </div>

        </div>

        <div class="column medium-6">
          <p class="label__helper-text">{{ dataService.language == 'ru' ? 'Не может начинаться с числа':'Cannot start with a number' }}</p>
          <p class="label__helper-text">{{ dataService.language == 'ru' ? 'Никаких специальных символов, кроме подчеркивания':'No special characters except underscore' }}</p>
        </div>
      </div>

      <!-- Password-->
      <div class="row">
        <div class="column medium-6">
          <div class="field-group-container">
            <legend>{{ dataService.language == 'ru' ? 'Пароль':'Password' }}</legend>

            <!-- Password -->
            <div class="field-group-container">
              <input id="password" name="password" type="password" ng-minlength="modalCtrl.minPasswordLength"
                ng-maxlength="modalCtrl.maxPasswordLength" autocomplete="new-password"
                ng-required="modalCtrl.user.new || form.password.$touched || form.passwordConfirm.$touched"
                ng-model="modalCtrl.user.password" ng-click="form.password.$setTouched()" placeholder="{{
                                (modalCtrl.user.new ||
                                form.password.$touched ||
                                form.passwordConfirm.$touched) ? '' : '******'}}" />
              <div ng-if="form.password.$invalid && form.password.$dirty" class="form__validation-message">
                <span ng-show="form.password.$error.required">
                  {{ dataService.language == 'ru' ? 'Обязательное поле':'Field is required' }}</span>
                <span ng-show="form.password.$error.minlength || form.password.$error.maxlength">
                  {{ dataService.language == 'ru' ? 'Длина должна быть между':'Length must be between' }} <span class="nowrap">{{modalCtrl.minPasswordLength}} –
                    {{modalCtrl.maxPasswordLength}}</span> {{ dataService.language == 'ru' ? 'символов':'characters' }}</span>
              </div>
            </div>
            <!-- Password confirm -->
            <div class="field-group-container">
              <label for="passwordConfirm" class="inline">{{ dataService.language == 'ru' ? 'Подтвердить пароль пользователя':'Confirm user password' }}</label>
              <input id="passwordConfirm" name="passwordConfirm" type="password" autocomplete="new-password"
                ng-required="modalCtrl.user.new || form.password.$touched || form.passwordConfirm.$touched"
                ng-model="modalCtrl.user.passwordConfirm" password-confirm first-password="form.password.$modelValue"
                ng-click="form.passwordConfirm.$setTouched()" placeholder="{{(
                                modalCtrl.user.new ||
                                form.password.$touched ||
                                form.passwordConfirm.$touched) ? '' : '******'}}" />
              <div ng-if="form.passwordConfirm.$invalid && form.passwordConfirm.$dirty"
                class="form__validation-message">
                <span ng-show="form.passwordConfirm.$error.required">
                  {{ dataService.language == 'ru' ? 'Обязательное поле':'Field is required' }}</span>
                <span ng-show="form.passwordConfirm.$error.passwordConfirm"
                  ng-hide="form.passwordConfirm.$error.required">
                  {{ dataService.language == 'ru' ? 'Пароли не совпадают':'Passwords do not match' }}</span>
                <span ng-show="form.passwordConfirm.$error.minlength || form.passwordConfirm.$error.maxlength">
                  {{ dataService.language == 'ru' ? 'Длина должна быть между':'Length must be between' }} <span class="nowrap">1 – 16</span> {{ dataService.language == 'ru' ? 'символов':'characters' }}</span>
              </div>
            </div>
          </div>

        </div>

        <div class="column medium-6">
          <p class="label__helper-text">{{ dataService.language == 'ru' ? 'Пароль должен быть между':'Password must between' }} <span class="nowrap">{{modalCtrl.minPasswordLength}} –
              {{modalCtrl.maxPasswordLength}}</span> {{ dataService.language == 'ru' ? 'символов':'characters' }}</p>
        </div>
      </div>

      <div class="row padding-top">

        <div class="column medium-6">
          <!-- Privilege -->
          <div class="field-group-container">
            <legend>{{ dataService.language == 'ru' ? 'Роль':'Role' }}</legend>
            <select id="privilege" name="privilege" required ng-disabled="modalCtrl.user.isRoot"
              ng-model="modalCtrl.user.privilege">
              <option ng-if="modalCtrl.user.new" ng-selected="modalCtrl.user.new" value="" disabled>
                {{ dataService.language == 'ru' ? 'Выберите вариант':'Select an option' }}
              </option>
              <option ng-value="role" ng-repeat="role in modalCtrl.privilegeRoles">
                {{role}}
              </option>
            </select>
          </div>
        </div>
        <div class="column medium-6">
          <!-- Account Status -->
          <fieldset class="field-group-container">
            <legend>{{ dataService.language == 'ru' ? 'Состояние учетной записи':'Account Status' }}</legend>
            <label class="radio-label inline">
              <input type="radio" name="accountStatus" ng-value="true" ng-model="modalCtrl.user.accountStatus"
                ng-disabled="modalCtrl.user.isRoot">
              {{ dataService.language == 'ru' ? 'Включена':'Enabled' }}
            </label>
            <label class="radio-label inline">
              <input type="radio" name="accountStatus1" ng-value="false" ng-model="modalCtrl.user.accountStatus"
                ng-disabled="modalCtrl.user.isRoot">
              {{ dataService.language == 'ru' ? 'Отключена':'Disabled' }}
            </label>
          </fieldset>

        </div>
      </div>

    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" ng-click="$dismiss()" type="button">
        {{ dataService.language == 'ru' ? 'Отменить':'Cancel' }}
      </button>
      <button class="btn btn-primary" type="submit" ng-click="$close(form)"
        ng-disabled="form.$invalid || form.$pristine" ng-class="{'disabled': form.$invalid}">
        {{ dataService.language == 'ru' ? (modalCtrl.user.new ? 'Добавить пользователя' : 'Сохранить'):(modalCtrl.user.new ? 'Add user' : 'Save') }}
      </button>
    </div>
  </form>
</div>